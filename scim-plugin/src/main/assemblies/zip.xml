<!--
  ~ Copyright 2011 UnboundID Corp.
  ~ All Rights Reserved.
  -->

<assembly
        xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
    <id>scim-plugin-bundle</id>
    <formats>
        <format>zip</format>
    </formats>
    <fileSets>
        <fileSet>
            <outputDirectory>.</outputDirectory>
            <directory>${project.build.directory}</directory>
            <includes>
                <include>3RD_PARTY_LICENSES.txt</include>
            </includes>
        </fileSet>
        <!-- TODO: we need to move the core server's GenerateLicenseText build tool
                   over to the Common module, then update SCIM to depend on Common
                   and use this tool to get the official UnboundID License text.
        <fileSet>
            <outputDirectory>.</outputDirectory>
            <directory>${project.build.directory}</directory>
            <includes>
                <include>CORE-UBID-LICENSE.txt</include>
            </includes>
        </fileSet>
        -->
        <fileSet>
            <outputDirectory>docs</outputDirectory>
            <directory>${project.reporting.outputDirectory}/extension-docs</directory>
        </fileSet>
        <fileSet>
            <outputDirectory>docs/javadoc</outputDirectory>
            <directory>${project.build.directory}/javadoc</directory>
        </fileSet>
        <fileSet>
            <outputDirectory>config</outputDirectory>
            <directory>${main.basedir}/resource</directory>
            <includes>
                <include>resources.xsd</include>
                <include>resources.xml</include>
            </includes>
        </fileSet>
        <fileSet>
            <outputDirectory>config/update</outputDirectory>
            <directory>${project.basedir}/src/main/assemblies/config/update</directory>
        </fileSet>
    </fileSets>
    <files>
        <file>
            <outputDirectory>config/update</outputDirectory>
            <destName>resources.xml.${build.svn.revision}</destName>
            <source>${main.basedir}/resource/resources.xml</source>
        </file>
        <file>
            <outputDirectory>config/update</outputDirectory>
            <destName>resources.xsd.${build.svn.revision}</destName>
            <source>${main.basedir}/resource/resources.xsd</source>
        </file>
    </files>
    <dependencySets>
        <dependencySet>
            <outputDirectory>lib</outputDirectory>
            <useProjectArtifact>false</useProjectArtifact>
            <excludes>
              <!-- Make sure we don't include any jars that the server already has. -->
              <exclude>com.unboundid.product:ldapsdk</exclude>
              <exclude>com.unboundid.product.ds:server-sdk</exclude>
              <exclude>javax.activation:activation</exclude>
              <exclude>org.eclipse.jetty:jetty-*</exclude>
              <exclude>org.mortbay.jetty:servlet-api</exclude>
              <exclude>org.json:json</exclude>
            </excludes> 
        </dependencySet>
        <dependencySet>
            <outputDirectory>.</outputDirectory>
            <useProjectArtifact>true</useProjectArtifact>
            <includes>
              <!--Only include the main artifact at the root -->
              <include>com.unboundid.product.scim:scim-plugin</include>
            </includes>
        </dependencySet>
    </dependencySets>
</assembly>
